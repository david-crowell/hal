<html>
<head>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
	<script type="text/javascript" src="/lib/jquery.tubular.1.0.js"></script>
	<script type="text/javascript" src="/alarm.js"></script>
	<script type="text/javascript" src="/hal.js"></script>
	<link rel="stylesheet" href="stylesheets/alarmclock.css" />
	<script type="text/javascript">	    		

		var AlarmClockController = {
			weatherVideos : {
				'snow' :  ['http://media.giphy.com/media/12UCxsXdazBCso/giphy.mp4',
						   'http://media.giphy.com/media/bnsWLCG5bEaiI/giphy.mp4',
						   'http://media.giphy.com/media/NyZcEHukr40Ja/giphy.mp4',
						   'http://media.giphy.com/media/aJ7YvM8rrpAEU/giphy.mp4'],
			    'rain' :  ['http://media.giphy.com/media/10lZZFTqlxU3u0/giphy.mp4',
			    		   'http://media.giphy.com/media/12GilBzHgblXAk/giphy.mp4',
			    		   'http://media.giphy.com/media/134nsKFTOjoy08/giphy.mp4',
			    		   'http://media.giphy.com/media/5f1tNZVLs2Lny/giphy.mp4'],
			    'fog' :   ['http://media.giphy.com/media/hL8a3mIQK8Ehy/giphy.mp4',
			    		   'http://media.giphy.com/media/zBHo3iX2OugcE/giphy.mp4'],
			    'sun' :   ['http://media.giphy.com/media/mg26nA30gBlgQ/giphy.mp4',
			    		   'http://media.giphy.com/media/H2BaDFFp6cCw8/giphy.mp4',
			    		   'http://media.giphy.com/media/TXp4miBlavqSY/giphy.mp4',
			    		   'http://media.giphy.com/media/QCsEPhEd8PpEA/giphy.mp4',
			    		   'http://media.giphy.com/media/UqWwKG1XGutck/giphy.mp4'],
			    'cloudy': ['http://media.giphy.com/media/6007IkHS1aFaM/giphy.mp4',
			    		   'http://media.giphy.com/media/SSoMlZJAVttUk/giphy.mp4',
			    		   'http://media.giphy.com/media/wvUpD8dydqYRW/giphy.mp4'],
			    'aurora': ['http://media.giphy.com/media/z1vZC8vItLg0E/giphy.mp4']
			},
			fireAlarm : function() {
				console.log('firing alarm!');
				var link = document.getElementById('musicloc').value;
				if (link) {
					window.open(link, 'alarm');
				} else {
					AlarmClockController.playAudio("http://www.palantir.net/2001/tma1/wav/zarathustra.wav");
				}
			},
			setAlarm : function(hours, minutes, seconds) {
				console.log('got it up here');
				this.alarm.setWakeTime(hours, minutes, seconds);
			},
			viewDidLoad : function() {
				this.controller = top.Controller;
				this.controller.alarmClockController = this;
				this.hal = this.controller.hal;
				this.hal.setWakeTimeCallback(this.setAlarm);
				this.alarm = new Alarm(this.fireAlarm, document.getElementById('currentTimeElement'), document.getElementById('wakeHoursInput'), document.getElementById('wakeMinutesInput'), document.getElementById('wakeSecondsInput'));
				this.alarm.start();
				this.setBackgroundVideo( this.getWeatherVideo() );
			},
			stopAlarm : function() {
				console.log(this);
				this.controller.clearAudio();
			},
			snoozeAlarm : function(minutes) {
				if (!minutes) {
					minutes = 5;
				}
				this.alarm.addMinutes(minutes);
			},
			setBackgroundVideo : function(link) {
				//var bgvid = document.getElementById("bgvid");
				//bgvid.setAttribute("src", link);
				$('#wrapper').tubular({videoId: 'e4Is32W-ppk', start: 3});
			},
			getWeatherVideo : function() {
				var weatherTypes = Object.keys(this.weatherVideos);
				var weather = weatherTypes[random(weatherTypes.length)];
				return this.weatherVideos[weather][random(this.weatherVideos[weather].length - 1)];
			},
			playAudio : function(location) {
				this.controller.playAudio(location);
			},
			clearAudio : function() {
				this.controller.clearAudio();
			}
		};

		function random(max, min) {
			if (min == null) { min = 0; }
			var r = Math.floor((Math.random() * 1000));
			var mod = (max-min) + 1;
			console.log('r: ' + r + ' mod: ' + mod);
			return (r % mod) + min;
		}

		$('document').ready(function() {
			var options = { videoId: 'e4Is32W-ppk', start: 3 };
			$('#wrapper').tubular(options);
			// f-UGhWj1xww cool sepia hd
			// 49SKbS7Xwf4 beautiful barn sepia
		});
	</script>
</head>
<body onload="AlarmClockController.viewDidLoad();">
<div id="wrapper">
	<button onclick="AlarmClockController.hal.start()">Good Morning, HAL</button>

	<br />
	<br />

	<!--video autoplay loop id="bgvid" src="http://media.giphy.com/media/bnsWLCG5bEaiI/giphy.mp4">
	</video-->

	<button onclick="AlarmClockController.snoozeAlarm();">SNOOZE</button>

	<form action="" method="">
	<div id="alarmclock">
	<div><div class="leftcolumn">Current Time:</div> <span id="currentTimeElement" style="letter-spacing: 2px"></span></div>
	<!-- div><div class="leftcolumn">Set Alarm:</div> <span><select></select> Hour</span> <span><select></select> Minutes</span> <span><select></select> Seconds</span></div -->
	<div><div class="leftcolumn">Set Alarm:</div> <input type="text" id="wakeHoursInput" size="2" align="right" value="0" /> Hours <input type="text" id="wakeMinutesInput" size="2" align="right" value="0" /> Minutes <input type="text" id="wakeSecondsInput" size="2" align="right" value="0" /> Seconds </div>
	<div><div class="leftcolumn">Set Alarm Action:</div> <input type="text" id="musicloc" size="55" /> <span style="font: normal 11px Tahoma">*leave blank for a thematic alternative</span></div>
	<!--input type="submit" value="Set Alarm!" id="submitbutton" /> <input type="reset" value="reset" id="resetbutton" /-->
	</div>
	</form>

	<br />
	<br />

	<button onclick="AlarmClockController.stopAlarm();">TURN OFF</button>
	<!--script type="text/javascript">

	var alarm = new Alarm(startAlarm, document.getElementById('currentTimeElement'), document.getElementById('wakeHoursInput'), document.getElementById('wakeMinutesInput'), document.getElementById('wakeSecondsInput'));
	alarm.start();

	</script-->
</div>
</body>
</html>

